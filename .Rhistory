# Number of Starbucks stores vs Density of Population
pc2 <- ggplot(df, aes(x = DensityOfPopulation, y = NbShops)) +
geom_point() +
xlab('Density of Population') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Kaggle') +
ggtitle('Starbucks Number vs Local Population Density') +
theme_fivethirtyeight() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5))
pc2
# Number of Starbucks stores vs Average Income
pc3 <- ggplot(df, aes(x = AverageIncome, y = NbShops)) +
geom_point() +
xlab('Average Income') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Kaggle') +
ggtitle('Starbucks Number vs Local Average Income') +
theme_fivethirtyeight() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc3
# Number of Starbucks stores vs Median Age
pc4 <- ggplot(df, aes(x = MedianAge, y = NbShops)) +
geom_point() +
xlab('Median Age') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Kaggle') +
ggtitle('Starbucks Number vs Local Median Age') +
theme_fivethirtyeight() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc4
# Number of Starbucks stores vs Density of Shops
pc5 <- ggplot(df, aes(x = DensityOfShops, y = NbShops)) +
geom_point() +
xlab('Density of Shops') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Kaggle') +
ggtitle('Starbucks Number vs Local Shop Density') +
theme_fivethirtyeight() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc5
library(ggplot2)
library(ggthemes)
library(ggrepel)
# Number of Starbucks stores vs Population
pc1 <- ggplot(df, aes(x = Population, y = NbShops)) +
geom_point(color = '#87dc97') +
xlab('Population') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Kaggle') +
ggtitle('Starbucks Number vs Local Population') +
theme_linedraw() +
geom_smooth(method=lm, se=FALSE, linetype="dashed") +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc1
# Number of Starbucks stores vs Density of Population
pc2 <- ggplot(df, aes(x = DensityOfPopulation, y = NbShops)) +
geom_point(color = '#87dc97') +
xlab('Density of Population') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Kaggle') +
ggtitle('Starbucks Number vs Local Population Density') +
theme_linedraw() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5))
pc2
# Number of Starbucks stores vs Average Income
pc3 <- ggplot(df, aes(x = AverageIncome, y = NbShops)) +
geom_point(color = '#87dc97') +
xlab('Average Income') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Kaggle') +
ggtitle('Starbucks Number vs Local Average Income') +
theme_linedraw() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc3
# Number of Starbucks stores vs Median Age
pc4 <- ggplot(df, aes(x = MedianAge, y = NbShops)) +
geom_point(color = '#87dc97') +
xlab('Median Age') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Kaggle') +
ggtitle('Starbucks Number vs Local Median Age') +
theme_linedraw() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc4
# Number of Starbucks stores vs Density of Shops
pc5 <- ggplot(df, aes(x = DensityOfShops, y = NbShops)) +
geom_point(color = '#87dc97') +
xlab('Density of Shops') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Kaggle') +
ggtitle('Starbucks Number vs Local Shop Density') +
theme_linedraw() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc5
library(ggplot2)
library(ggthemes)
library(ggrepel)
# Number of Starbucks stores vs Population
pc1 <- ggplot(df, aes(x = Population, y = NbShops)) +
geom_point(color = '#87dc97') +
xlab('Population') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Data Source: Kaggle') +
ggtitle('Starbucks Number vs Local Population') +
theme_linedraw() +
geom_smooth(method=lm, se=FALSE, linetype="dashed") +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc1
# Number of Starbucks stores vs Density of Population
pc2 <- ggplot(df, aes(x = DensityOfPopulation, y = NbShops)) +
geom_point(color = '#87dc97') +
xlab('Density of Population') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Data Source: Kaggle') +
ggtitle('Starbucks Number vs Local Population Density') +
theme_linedraw() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5))
pc2
# Number of Starbucks stores vs Average Income
pc3 <- ggplot(df, aes(x = AverageIncome, y = NbShops)) +
geom_point(color = '#87dc97') +
xlab('Average Income') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Data Source: Kaggle') +
ggtitle('Starbucks Number vs Local Average Income') +
theme_linedraw() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc3
# Number of Starbucks stores vs Median Age
pc4 <- ggplot(df, aes(x = MedianAge, y = NbShops)) +
geom_point(color = '#87dc97') +
xlab('Median Age') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Data Source: Kaggle') +
ggtitle('Starbucks Number vs Local Median Age') +
theme_linedraw() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc4
# Number of Starbucks stores vs Density of Shops
pc5 <- ggplot(df, aes(x = DensityOfShops, y = NbShops)) +
geom_point(color = '#87dc97') +
xlab('Density of Shops') +
ylab('Number of Starbucks Stores in the County') +
labs(caption = 'Data Source: Kaggle') +
ggtitle('Starbucks Number vs Local Shop Density') +
theme_linedraw() +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc5
library(jtools)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(stringr)
df <- read.csv('raw_data/coffee_compare.csv')
coffee <- df %>% select(DBA, reinspections, checks, violations,
score, inspections, BORO, SCORE)
coffee$DBA = ifelse(str_detect(coffee$DBA, "DUNKIN"), 'DD', 'Starbucks')
coffee %>%
select(BORO, DBA) %>%
group_by(BORO) %>%
table()
library(ggthemes)
library(ggplot2)
library(plotly)
coffee_new <- coffee %>%
group_by(DBA, BORO) %>%
summarize(Value = n())
pc <- ggplot(coffee_new, aes(fill=DBA, y=Value, x=BORO)) +
geom_bar(position="dodge", stat="identity", width = 0.5) +
xlab('Neighborhood') +
ylab('Health Violations') +
labs(caption = 'Data Source: DOHMH',
fill = 'Brands') +
ggtitle('Health Violations of Coffee Brands by Neighborhoods') +
theme_bw() +
scale_fill_manual(values = c("#f09a56", "#87dc97")) +
theme(plot.title = element_text(size=12, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc
pc1 <- ggplot(coffee, aes(x = BORO, y = violations, color = DBA)) +
geom_point(alpha = 0.5) +
xlab('Neighborhood') +
ylab('Health Violations') +
labs(caption = 'DOHMH') +
ggtitle('Health Violations of Coffee Brands by Neighborhoods') +
theme_bw() +
theme(plot.title = element_text(size=12, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8)) +
scale_color_manual(values = c("DD" = "#f09a56",
'Starbucks' = "#87dc97"))
ggplotly(pc1)
coffee_new <- coffee %>%
group_by(DBA, BORO) %>%
summarize(total_vio = sum(violations, na.rm = T))
pc11 <- ggplot(coffee_new,
aes(fill=DBA, y=total_vio, x=BORO)) +
geom_bar(position="dodge", stat="identity", width = 0.5) +
xlab('Neighborhood') +
ylab('Health Violations') +
labs(caption = 'Data Source: DOHMH',
fill = 'Brands') +
ggtitle('Health Violations of Coffee Brands by Neighborhoods') +
theme_bw() +
scale_fill_manual(values = c("#f09a56", "#87dc97")) +
theme(plot.title = element_text(size=12, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc11
pc2 <- ggplot(coffee, aes(x = BORO, y = SCORE, color = DBA)) +
geom_point(alpha = 0.5) +
xlab('Neighborhood') +
ylab('Total Score for a Particular Inspection') +
labs(caption = 'DOHMH') +
ggtitle('Score of Coffee Brands by Neighborhoods') +
theme_bw() +
theme(plot.title = element_text(size=12, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8)) +
scale_color_manual(values = c("DD" = "#f09a56",
'Starbucks' = "#87dc97"))
ggplotly(pc2)
coffee_new <- coffee %>%
group_by(DBA, BORO) %>%
summarize(total_score = sum(SCORE, na.rm = T))
pc11 <- ggplot(coffee_new,
aes(fill=DBA, y=total_score, x=BORO)) +
geom_bar(position="dodge", stat="identity", width = 0.5) +
xlab('Neighborhood') +
ylab('Total Score for a Particular Inspection') +
labs(caption = 'Data Source: DOHMH',
fill = 'Brands') +
ggtitle('Inspection Score of Coffee Brands by Neighborhoods') +
theme_bw() +
scale_fill_manual(values = c("#f09a56", "#87dc97")) +
theme(plot.title = element_text(size=12, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc11
library(jtools)
coffee_lm <- coffee %>%
group_by(DBA, BORO) %>%
summarize(total_num = n(),
total_vio = sum(violations, na.rm = T),
total_score = sum(SCORE, na.rm = T))
coffee_lm$DBA = ifelse(coffee_lm$DBA == "DD", 1, 0)
coffee_sb <- coffee_lm %>% filter(DBA == 1)
coffee_dd <- coffee_lm %>% filter(DBA == 0)
lm <- lm(total_num ~ total_vio + total_score,
data = coffee_sb)
summary(lm)
summ(lm)
lm <- lm(total_num ~ total_vio + total_score,
data = coffee_dd)
summary(lm)
summ(lm)
lm1 <- lm(total_vio ~ total_num,
data = coffee_sb)
summary(lm1)
summ(lm)
lm1 <- lm(total_vio ~ total_num,
data = coffee_dd)
summary(lm1)
summ(lm1)
lm2 <- lm(total_vio ~ total_num*DBA,
data = coffee_lm)
summary(lm2)
summ(lm2)
lm2 <- lm(total_score ~ total_num*DBA,
data = coffee_lm)
summary(lm2)
summ(lm2)
library(caret)
coffee$DBA = ifelse(coffee$DBA == "DD", 0, 1)
coffee$DBA <- factor(coffee$DBA,
labels = c("Starbucks", "DD"),
levels = 1:0)
set.seed(12345)
in_train <- createDataPartition(y = coffee$DBA,
p = 0.8, list = FALSE)
training <- coffee[ in_train, ]
testing  <- coffee[-in_train, ]
logit <- glm(DBA ~ checks + violations + score + BORO,
data = training, family = binomial(link = "logit"))
y_hat_logit <- predict(logit, newdata = testing, type = "response")
z_logit <- factor(y_hat_logit > 0.5,
levels = c(TRUE, FALSE),
labels = c("Starbucks", "DD"))
confusionMatrix(z_logit, reference = testing$DBA)
LDA <- train(DBA ~ checks + violations + score + BORO,
data = training, method = "lda",
reProcess = c("center", "scale"))
z <- predict(LDA, newdata = testing)
confusionMatrix(z, testing$DBA)
pc <- ggplot(df, aes(y=NbShops, x=County)) +
geom_bar(position="dodge", stat="identity",
fill="steelblue", width = 0.5) +
xlab('Neighborhood') +
ylab('Health Violations') +
labs(caption = 'Data Source: DOHMH',
fill = 'Brands') +
ggtitle('Health Violations of Coffee Brands by Neighborhoods') +
theme_linedraw() +
geom_text(aes(label=n), vjust=1.6, color="white", size=3.5) +
scale_fill_manual(values = c("#f09a56", "#87dc97")) +
theme(plot.title = element_text(size=12, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc
df %>% arrange(desc(NbShops))
knitr::opts_chunk$set(echo = TRUE)
library(readr)
df <- read.csv('raw_data/num_starbucks_nyc.csv')
library(dplyr)
df %>% summary()
df %>% arrange(desc(NbShops))
pc <- ggplot(df, aes(y=NbShops, x=County)) +
geom_bar(position="dodge", stat="identity",
fill="steelblue", width = 0.5) +
xlab('Neighborhood') +
ylab('Health Violations') +
labs(caption = 'Data Source: DOHMH',
fill = 'Brands') +
ggtitle('Health Violations of Coffee Brands by Neighborhoods') +
theme_linedraw() +
geom_text(aes(label=n), vjust=1.6, color="white", size=3.5) +
scale_fill_manual(values = c("#f09a56", "#87dc97")) +
theme(plot.title = element_text(size=12, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc
pc <- ggplot(df, aes(y=NbShops, x=County)) +
geom_bar(position="dodge", stat="identity",
fill="steelblue", width = 0.5) +
xlab('Neighborhood') +
ylab('Health Violations') +
labs(caption = 'Data Source: DOHMH',
fill = 'Brands') +
ggtitle('Health Violations of Coffee Brands by Neighborhoods') +
theme_linedraw() +
geom_text(aes(label=n), vjust=1.6, color="white", size=3.5) +
scale_fill_manual(values = c("#f09a56", "#87dc97")) +
theme(plot.title = element_text(size=12, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc
library(ggplot2)
library(ggthemes)
library(ggrepel)
pc <- ggplot(df, aes(y=NbShops, x=County)) +
geom_bar(position="dodge", stat="identity",
fill="steelblue", width = 0.5) +
xlab('Neighborhood') +
ylab('Health Violations') +
labs(caption = 'Data Source: DOHMH',
fill = 'Brands') +
ggtitle('Health Violations of Coffee Brands by Neighborhoods') +
theme_linedraw() +
geom_text(aes(label=n), vjust=1.6, color="white", size=3.5) +
scale_fill_manual(values = c("#f09a56", "#87dc97")) +
theme(plot.title = element_text(size=12, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc
df <- df %>% arrange(desc(NbShops))
library(ggplot2)
library(ggthemes)
library(ggrepel)
pc <- ggplot(df, aes(y=NbShops, x=County)) +
geom_bar(position="dodge", stat="identity",
fill="steelblue", width = 0.5) +
xlab('Neighborhood') +
ylab('Health Violations') +
labs(caption = 'Data Source: DOHMH',
fill = 'Brands') +
ggtitle('Health Violations of Coffee Brands by Neighborhoods') +
theme_linedraw() +
geom_text(aes(label=n), vjust=1.6, color="white", size=3.5) +
scale_fill_manual(values = c("#f09a56", "#87dc97")) +
theme(plot.title = element_text(size=12, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc
df <- df %>% arrange(desc(NbShops))
df
library(ggplot2)
library(ggthemes)
library(ggrepel)
pc <- ggplot(df, aes(y=NbShops, x=County)) +
geom_bar(position="dodge", stat="identity",
fill="#87dc97", width = 0.4) +
xlab('County') +
ylab('Number of Starbucks') +
labs(caption = 'Data Source: Kaggle') +
ggtitle('Numer of Starbucks by Counties') +
theme_minimal() +
geom_text(aes(label=n), vjust=1.6, color="white", size=3.5) +
theme(plot.title = element_text(size=14, face="bold",
hjust = 0.5))
pc
View(df)
library(ggplot2)
library(ggthemes)
library(ggrepel)
pc <- ggplot(df, aes(y=df$NbShops, x=df$County)) +
geom_bar(position="dodge", stat="identity",
fill="#87dc97", width = 0.4) +
xlab('County') +
ylab('Number of Starbucks') +
labs(caption = 'Data Source: Kaggle') +
ggtitle('Numer of Starbucks by Counties') +
theme_minimal() +
geom_text(aes(label=n), vjust=1.6, color="white", size=3.5) +
theme(plot.title = element_text(size=14, face="bold",
hjust = 0.5))
pc
dv <- df %>% arrange(desc(NbShops))
dv
dv <- df %>% arrange(desc(NbShops)) %>%
select(County, NbShops)
dv
library(ggplot2)
library(ggthemes)
library(ggrepel)
pc <- ggplot(dv, aes(y=NbShops, x=County)) +
geom_bar(position="dodge", stat="identity",
fill="#87dc97", width = 0.4) +
xlab('County') +
ylab('Number of Starbucks') +
labs(caption = 'Data Source: Kaggle') +
ggtitle('Numer of Starbucks by Counties') +
theme_minimal() +
geom_text(aes(label=n), vjust=1.6, color="white", size=3.5) +
theme(plot.title = element_text(size=14, face="bold",
hjust = 0.5))
pc
class(dv$NbShops)
library(ggplot2)
library(ggthemes)
library(ggrepel)
pc <- ggplot(dv, aes(y=as.numeric(NbShops), x=County)) +
geom_bar(position="dodge", stat="identity",
fill="#87dc97", width = 0.4) +
xlab('County') +
ylab('Number of Starbucks') +
labs(caption = 'Data Source: Kaggle') +
ggtitle('Numer of Starbucks by Counties') +
theme_minimal() +
geom_text(aes(label=n), vjust=1.6, color="white", size=3.5) +
theme(plot.title = element_text(size=14, face="bold",
hjust = 0.5))
pc
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(broom)
nyc_demo <- read_csv("nyc_zip_demo.csv")
nyc_demo_more <- read_csv('raw_data/nyc_zip_demographics.csv')
nyc_demo <- left_join(nyc_demo, nyc_demo_more,by = c("Zipcode" = "ZIPCODE"))
coffee_zip <- read_csv("coffee_zip.csv")
df <- left_join(coffee_zip, nyc_demo) %>%
mutate(Women_pct = 100 - Men_pct)
library(ggthemes)
library(ggplot2)
library(tidyr)
pc1 <- ggplot(df, aes(x = Total_Income, y = Avg_rating,
color = Name)) +
geom_point(alpha = 0.8, radius = 0.5) +
xlab('Total Income') +
ylab('Average Rating for Coffee Shops') +
labs(caption = 'Data Source: Yelp') +
geom_smooth(method=lm, se=FALSE, linetype="dashed") +
ggtitle('Total Income vs Average Rating for Coffee') +
theme_linedraw() +
scale_color_manual(values = c("#34afd1", "#f09a56",
"#87dc97")) +
theme(plot.title = element_text(size=14, face="bold", hjust = 0.5),
legend.text = element_text(size=8),
legend.title = element_text(size=8))
pc1
coffee_lm <- df
coffee_lm$Name[coffee_lm$Name == "Dunkin'"] <- 0
coffee_lm$Name[coffee_lm$Name == "Starbucks"] <- 1
coffee_lm$Name[coffee_lm$Name == "Blue Bottle"] <- 2
coffee_sb <- coffee_lm %>% filter(Name == 1)
coffee_dd <- coffee_lm %>% filter(Name == 0)
coffee_bb <- coffee_lm %>% filter(Name == 2)
write_csv(coffee_sb, "./cleaned_sb_only.csv", na = "NA" )
write_csv(coffee_dd, "./cleaned_dd_only.csv", na = "NA" )
